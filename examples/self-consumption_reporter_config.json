{
    "required_input" :[{"name":"production","unit": "kW"},{"name":"aggregate-power","unit": "kW"}, {"name":"battery-power","unit": "kW"}],
    "required_output" :[{"name":"self-consumption","unit": "kW"}],
    "droplevels": true,
        "transformations" : [
            {
                "df_input": "battery-power",
                "df_output": "battery-consumption",
                "method": "clip",
                "kwargs": {
                    "lower": 0
                }
            },
            {
                "df_input": "battery-power",
                "df_output": "battery-production",
                "method": "clip",
                "kwargs": {
                    "upper": 0
                }
            },
            {
                "df_input": "battery-production",
                "df_output": "battery-production",
                "method": "multiply",
                "args": [-1]
            },
            {
                "df_input": "aggregate-power",
                "df_output": "feed_in",
                "method": "clip",
                "kwargs": {
                    "upper": 0
                }
            },
            {
                "df_input": "feed_in",
                "df_output": "feed_in",
                "method": "multiply",
                "args": [-1]

            },
            {
                "df_input": "production",
                "df_output": "total-production",
                "method": "add",
                "args": ["@battery-production"]
            },
            {
                "df_input": "total-production",
                "df_output": "self-consumption",
                "method": "sub",
                "args": ["@feed_in"]
            },
            {
                "df_input": "self-consumption",
                "df_output": "self-consumption",
                "method": "sub",
                "args": ["@battery-consumption"]
            }


     ]
}
